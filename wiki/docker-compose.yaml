version: '3.8'

services:
  hajimi-app:
    image: beijixingxing/hajimi:latest
    container_name: hajimi-app  # å›ºå®šå®¹å™¨åæ–¹ä¾¿ç›‘æ§
    labels:
      - "com.centurylinklabs.watchtower.enable=true"  # å¯ç”¨è‡ªåŠ¨æ›´æ–°
    ports:
      - "7860:7860"  # å·¦è¾¹æ˜¯å¤–éƒ¨ç«¯å£ï¼ˆå¯æ”¹ï¼‰ï¼Œå³è¾¹æ˜¯å®¹å™¨ç«¯å£ï¼ˆåˆ«åŠ¨ï¼‰
    env_file:
      - .env  
    environment:
      - TZ=Asia/Shanghai # ä¸­å›½æ—¶åŒº
      - HTTP_PROXY=http://127.0.0.1:7890  # ä»£ç†åœ°å€ï¼Œè‡ªè¡Œä¿®æ”¹ï¼‰
      - HTTPS_PROXY=http://127.0.0.1:7890  # åŒä¸Šï¼Œä¿æŒä¸€æ ·å°±è¡Œ
    restart: unless-stopped # è‡ªåŠ¨é‡å¯ï¼Œä½†æ‰‹åŠ¨åœæ­¢åä¸å†é‡å¯

  # ğŸ†™ è‡ªåŠ¨æ›´æ–°ç›‘æ§æœåŠ¡ï¼ˆé»˜è®¤æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
  watchtower:
    image: containrrr/watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock  # å¿…é¡»çš„Dockerè¿æ¥é…ç½®
    environment:
      - TZ=Asia/Shanghai # ä¸­å›½æ—¶åŒº
      - WATCHTOWER_LABEL_ENABLE=true  # åªç›‘æ§å¸¦æ›´æ–°æ ‡ç­¾çš„å®¹å™¨
      - WATCHTOWER_POLL_INTERVAL=3600  # æ£€æŸ¥é—´éš”ç§’æ•°ï¼ˆ3600=1å°æ—¶ï¼‰
      - WATCHTOWER_CLEANUP=true  # æ›´æ–°åè‡ªåŠ¨åˆ é™¤æ—§é•œåƒ
    command: --interval 3600  # åŒé‡ç¡®è®¤é—´éš”æ—¶é—´
    restart: unless-stopped # è‡ªåŠ¨é‡å¯ï¼Œä½†æ‰‹åŠ¨åœæ­¢åä¸å†é‡å¯
